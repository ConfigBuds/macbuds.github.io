<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MacBuds - To help mac admins</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'JetBrains Mono', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0e0a 0%, #000000 100%);
            color: #00ff41;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .terminal-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }
        .terminal-window {
            background: #001100;
            border-radius: 12px;
            border: 2px solid #00ff41;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.4), 0 20px 40px rgba(0, 0, 0, 0.5);
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .terminal-header {
            background: #0d1b0d;
            padding: 16px 20px;
            border-bottom: 2px solid #00ff41;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .terminal-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .terminal-buttons {
            display: flex;
            gap: 8px;
        }
        .terminal-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .btn-close { background: #ff4444; }
        .btn-minimize { background: #ffaa00; }
        .btn-maximize { background: #00ff41; }
        .terminal-title {
            font-size: 13px;
            color: #55ff55;
            font-weight: 500;
        }
        .terminal-content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            background: #0a0e0a;
            position: relative;
        }
        .status-bar {
            background: #0d1b0d;
            border-top: 2px solid #00ff41;
            padding: 8px 16px;
            font-size: 11px;
            color: #55ff55;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status-left {
            display: flex;
            gap: 16px;
        }
        .status-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ff41;
            box-shadow: 0 0 5px #00ff41;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 5px #00ff41; }
            50% { box-shadow: 0 0 15px #00ff41, 0 0 25px #00ff41; }
            100% { box-shadow: 0 0 5px #00ff41; }
        }
        .github-link {
            color: #55ff55;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .github-link:hover {
            color: #00ff41;
            text-decoration: underline;
        }
        .tools-btn {
            background: #0d1b0d;
            color: #00ff41;
            border: 2px solid #00ff41;
            border-radius: 12px;
            padding: 20px 60px;
            font-size: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 24px;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.3), 0 0 20px rgba(0, 255, 65, 0.1) inset;
        }
        .tools-btn:hover {
            background: #112211;
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5), 0 0 30px rgba(0, 255, 65, 0.2) inset;
        }
        .timer-overlay {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #000000 0%, #0a0e0a 100%);
            z-index: 10000;
            cursor: none;
        }
        .timer-overlay.active {
            display: flex;
        }
        .timer-display {
            color: #00ff41;
            font-size: clamp(4rem, 12vw, 8rem);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
            margin-bottom: 48px;
            text-shadow: 
                0 0 20px #00ff41,
                0 0 40px #00ff41,
                0 0 60px #00ff41,
                0 0 80px #00ff41;
            animation: matrix-glow 2s ease-in-out infinite alternate;
            letter-spacing: 0.1em;
            text-align: center;
        }
        @keyframes matrix-glow {
            from { 
                text-shadow: 
                    0 0 20px #00ff41,
                    0 0 40px #00ff41,
                    0 0 60px #00ff41;
            }
            to { 
                text-shadow: 
                    0 0 30px #00ff41,
                    0 0 60px #00ff41,
                    0 0 90px #00ff41,
                    0 0 120px #00ff41;
            }
        }
        .timer-controls {
            display: flex;
            gap: 32px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .timer-overlay:hover .timer-controls {
            opacity: 1;
        }
        .timer-info {
            position: absolute;
            top: 50px;
            left: 50px;
            color: #55ff55;
            font-size: 1.2rem;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .timer-overlay:hover .timer-info {
            opacity: 1;
        }
        .timer-instructions {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            color: #77ff77;
            font-size: 1rem;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .timer-overlay:hover .timer-instructions {
            opacity: 1;
        }
        .wake-lock-status {
            position: absolute;
            top: 50px;
            right: 50px;
            color: #55ff55;
            font-size: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .timer-overlay:hover .wake-lock-status {
            opacity: 1;
        }
        .wake-lock-active {
            color: #00ff41;
        }
        .wake-lock-inactive {
            color: #ff4444;
        }
        /* Fullscreen styles */
        .timer-overlay:-webkit-full-screen {
            background: linear-gradient(135deg, #000000 0%, #0a0e0a 100%);
        }
        .timer-overlay:-moz-full-screen {
            background: linear-gradient(135deg, #000000 0%, #0a0e0a 100%);
        }
        .timer-overlay:fullscreen {
            background: linear-gradient(135deg, #000000 0%, #0a0e0a 100%);
        }
        /* Responsive design */
        @media (max-width: 768px) {
            .timer-display {
                font-size: clamp(2.5rem, 10vw, 6rem);
                margin-bottom: 32px;
            }
            .timer-info,
            .wake-lock-status {
                font-size: 1rem;
                top: 30px;
            }
            .timer-info {
                left: 30px;
            }
            .wake-lock-status {
                right: 30px;
            }
            .timer-instructions {
                font-size: 0.9rem;
                bottom: 30px;
            }
            .timer-controls {
                gap: 20px;
            }
            .tools-btn {
                padding: 15px 40px;
                font-size: 1.2rem;
            }
        }
        /* Animation for digits */
        .timer-display {
            background: linear-gradient(45deg, #00ff41, #33ff33, #00ff41);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: matrix-glow 2s ease-in-out infinite alternate,
                       gradient-shift 3s ease-in-out infinite;
        }
        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <div class="terminal-window">
            <div class="terminal-header">
                <div class="terminal-left">
                    <div class="terminal-buttons">
                        <div class="terminal-btn btn-close"></div>
                        <div class="terminal-btn btn-minimize"></div>
                        <div class="terminal-btn btn-maximize"></div>
                    </div>
                    <div class="terminal-title">macadmin@macbuds — zsh — 80×24</div>
                </div>
            </div>
            <div class="terminal-content-wrapper">
                <button class="tools-btn" id="startTimerBtn">
                    <i class="fas fa-clock"></i> Start Focus Timer
                </button>
                <div class="timer-overlay" id="timerOverlay">
                    <div class="timer-info" id="timerInfo">Focus Timer Active</div>
                    <div class="wake-lock-status" id="wakeLockStatus">Screen Wake Lock: Inactive</div>
                    <div class="timer-display" id="timerDisplay">00:00:00</div>
                    <div class="timer-controls">
                        <button class="tools-btn" id="stopTimerBtn">
                            <i class="fas fa-stop"></i> Stop & Exit
                        </button>
                    </div>
                    <div class="timer-instructions">
                        Hover to show controls • Press ESC to exit • Move mouse to prevent sleep
                    </div>
                </div>
            </div>
            <div class="status-bar">
                <div class="status-left">
                    <div class="status-item">
                        <div class="status-dot"></div>
                        <span>Connected</span>
                    </div>
                    <div class="status-item">
                        <i class="fab fa-github" style="font-size: 10px;"></i>
                        <a href="https://github.com/macbuds" class="github-link">macbuds</a>
                    </div>
                </div>
                <div class="status-right">
                    <span>© 2025 MacBuds</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let timerInterval, timerStart, wakeLock = null, mouseMoveInterval;
        const startTimerBtn = document.getElementById('startTimerBtn');
        const timerOverlay = document.getElementById('timerOverlay');
        const timerDisplay = document.getElementById('timerDisplay');
        const stopTimerBtn = document.getElementById('stopTimerBtn');
        const wakeLockStatus = document.getElementById('wakeLockStatus');
        const timerInfo = document.getElementById('timerInfo');

        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const h = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
            const m = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const s = String(totalSeconds % 60).padStart(2, '0');
            return `${h}:${m}:${s}`;
        }

        function simulateMouseMove() {
            // Create a very small mouse movement to prevent screen sleep
            const event = new MouseEvent('mousemove', {
                view: window,
                bubbles: true,
                cancelable: true,
                clientX: Math.random() * 5,
                clientY: Math.random() * 5
            });
            document.dispatchEvent(event);
        }

        async function requestWakeLock() {
            try {
                if ('wakeLock' in navigator) {
                    wakeLock = await navigator.wakeLock.request('screen');
                    wakeLockStatus.textContent = 'Screen Wake Lock: Active';
                    wakeLockStatus.className = 'wake-lock-status wake-lock-active';
                    console.log('Wake lock activated');
                    
                    wakeLock.addEventListener('release', () => {
                        wakeLockStatus.textContent = 'Screen Wake Lock: Released';
                        wakeLockStatus.className = 'wake-lock-status wake-lock-inactive';
                        console.log('Wake lock released');
                    });
                } else {
                    wakeLockStatus.textContent = 'Screen Wake Lock: Not Supported';
                    wakeLockStatus.className = 'wake-lock-status wake-lock-inactive';
                    console.log('Wake Lock API not supported');
                }
            } catch (err) {
                wakeLockStatus.textContent = 'Screen Wake Lock: Failed';
                wakeLockStatus.className = 'wake-lock-status wake-lock-inactive';
                console.error('Wake lock failed:', err);
            }
        }

        function releaseWakeLock() {
            if (wakeLock) {
                wakeLock.release();
                wakeLock = null;
            }
        }

        async function enterFullscreen() {
            try {
                if (timerOverlay.requestFullscreen) {
                    await timerOverlay.requestFullscreen();
                } else if (timerOverlay.webkitRequestFullscreen) {
                    await timerOverlay.webkitRequestFullscreen();
                } else if (timerOverlay.msRequestFullscreen) {
                    await timerOverlay.msRequestFullscreen();
                }
            } catch (err) {
                console.error('Fullscreen failed:', err);
            }
        }

        function exitFullscreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
        }

        async function startTimer() {
            timerStart = Date.now();
            timerDisplay.textContent = '00:00:00';
            timerOverlay.classList.add('active');
            
            // Hide cursor and prevent scrolling
            document.body.style.overflow = 'hidden';
            document.body.style.cursor = 'none';
            
            // Enter fullscreen
            await enterFullscreen();
            
            // Request wake lock
            await requestWakeLock();
            
            // Start the timer
            timerInterval = setInterval(() => {
                const elapsed = Date.now() - timerStart;
                timerDisplay.textContent = formatTime(elapsed);
            }, 1000);
            
            // Start mouse movement simulation every 30 seconds
            mouseMoveInterval = setInterval(simulateMouseMove, 30000);
            
            // Also simulate mouse movement every 2 minutes as backup
            setTimeout(() => {
                const backupInterval = setInterval(() => {
                    if (timerOverlay.classList.contains('active')) {
                        simulateMouseMove();
                    } else {
                        clearInterval(backupInterval);
                    }
                }, 120000);
            }, 5000);
        }

        function stopTimer() {
            // Clear intervals
            clearInterval(timerInterval);
            clearInterval(mouseMoveInterval);
            
            // Release wake lock
            releaseWakeLock();
            
            // Exit fullscreen
            exitFullscreen();
            
            // Hide timer overlay
            timerOverlay.classList.remove('active');
            
            // Restore normal cursor and scrolling
            document.body.style.overflow = '';
            document.body.style.cursor = '';
            
            // Reset status
            wakeLockStatus.textContent = 'Screen Wake Lock: Inactive';
            wakeLockStatus.className = 'wake-lock-status wake-lock-inactive';
        }

        // Event listeners
        if (startTimerBtn) {
            startTimerBtn.addEventListener('click', startTimer);
        }

        if (stopTimerBtn) {
            stopTimerBtn.addEventListener('click', stopTimer);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (timerOverlay.classList.contains('active')) {
                if (e.key === 'Escape' || e.key === 'Esc') {
                    stopTimer();
                }
            }
        });

        // Handle visibility change (when user switches tabs or minimizes)
        document.addEventListener('visibilitychange', async () => {
            if (timerOverlay.classList.contains('active') && !document.hidden) {
                // Re-request wake lock when page becomes visible again
                await requestWakeLock();
            }
        });

        // Prevent accidental closing
        window.addEventListener('beforeunload', (e) => {
            if (timerOverlay.classList.contains('active')) {
                e.preventDefault();
                e.returnValue = 'Timer is running. Are you sure you want to leave?';
            }
        });

        // Handle fullscreen change
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && timerOverlay.classList.contains('active')) {
                // If fullscreen is exited but timer is still active, try to re-enter
                setTimeout(() => {
                    if (timerOverlay.classList.contains('active')) {
                        enterFullscreen();
                    }
                }, 1000);
            }
        });

        // Additional mouse movement on user interaction
        let lastUserInteraction = Date.now();
        
        ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart'].forEach(event => {
            document.addEventListener(event, () => {
                lastUserInteraction = Date.now();
            });
        });

        // Periodic check for user inactivity
        setInterval(() => {
            if (timerOverlay.classList.contains('active')) {
                const timeSinceLastInteraction = Date.now() - lastUserInteraction;
                // If no user interaction for 60 seconds, simulate mouse move
                if (timeSinceLastInteraction > 60000) {
                    simulateMouseMove();
                }
            }
        }, 60000);
    </script>
</body>
</html>
